---
title: "04.CTmax_data_analysis"
author: "Elliott Schmidt"
date: "`r Sys.Date()`"
output: 
  html_document: 
    toc: true  
    toc_depth: 4
    toc_float: true
    code_folding: show
    collapse: no
    df_print: paged
    fig_caption: yes
    fig_height: 4
    fig_width: 6
    highlight: monochrome
    theme: cerulean
    latex_engine: xelatex
--- 

# Scenario 

Within this chapter developmental plasticity was explored within _Acanthochromis polyacanthus_ that were collected from two different regions (i.e., low-latitude, Cairns, and high-latitude, Mackay). Fish were held in common garden experiments at 28.5 C. Clutch data was collected along with parental morphometeric data to determine how fish from each population performed at 28.5 C, a temperature that was shown to produce similar absoluate aerobic scope performances in a previous study [link]. Once hatched offspring were placed into three different temperature treatments, 28.5, 30, and 31.5 C. After approximately 5-6 months offspring length and weight was measured, as well as CTmax and respiration during CTmax trials. 

# Load packages 

```{r load-packages-1, warning=FALSE, message=FALSE}
library(tidyverse) # data manipulation
library(ggpubr) # figure arrangement 
library(brms) # Bayesian models
library(StanHeaders)# needed to run Bayesian models
library(rstan) # needed to run Bayesian models
library(standist) # needs to be installed 
library(bayesplot) # needed for MCMC diagnostics 
library(DHARMa) # model validation 
library(ggdist) # partial plots 
library(tidybayes) # partial plots 
library(broom.mixed) # model investigation
library(emmeans) # pairwise comparisons
library(rstanarm) # pairwise comparisons - need for emmeans
```

# Set working directory 

```{r setwd-1, echo=FALSE}
knitr::opts_knit$set(root.dir="C:/Users/jc527762/OneDrive - James Cook University/PhD dissertation/Data/Chapter4_Latitude")
``` 

```{r setwd-2, echo=TRUE, eval=FALSE}
knitr::opts_knit$set(root.dir=working.dir)
```

# Import data 

```{r import-data-1, message=FALSE}
ctmax <- read_delim("import_files/CTmax_data.txt", 
    delim = "\t", escape_double = FALSE, 
    col_types = cols(LOE_MEAN_EAS = col_number(), 
        ...30 = col_skip(), ...31 = col_skip()), 
    trim_ws = TRUE)

clutch_data <- read_delim("./import_files/clutch_data_2022_2023.txt")|> 
  mutate(PROJECT_CODE = factor(PROJECT_CODE), 
         FEMALE = factor(FEMALE)) |>
  filter(PROJECT_CODE == "2"| 
         PROJECT_CODE == "3"|
         PROJECT_CODE == "6"|
         PROJECT_CODE == "7")
```

# Data manipulation 

```{r data manipulation, warning=FALSE}
ctmax2 <- ctmax |> 
  mutate(EXP_TANK = factor(EXP_TANK), 
         TRAY_ORD = factor(TRAY_ORD), 
         TRAY_COL = factor(TRAY_COL)) |>
  mutate(EXP_TANK = case_when(EXP_TANK = is.na(EXP_TANK) ~ "999", 
                              TRUE ~ EXP_TANK), 
         TRAY_ORD = case_when(TRAY_ORD = is.na(TRAY_ORD) ~ "999", 
                              TRUE ~ TRAY_ORD), 
         TRAY_COL = case_when(TRAY_COL = is.na(TRAY_COL) ~ "black", 
                              TRUE ~ TRAY_COL)) |>
  mutate(CLUTCH_NUMBER = factor(CLUTCH_NUMBER), 
         MALE = factor(MALE), 
         FEMALE = factor(FEMALE), 
         REGION = factor(REGION), 
         POPULATION = factor(POPULATION), 
         DATE_OF_HATCH = as.Date(DATE_OF_HATCH, format = "%d/%m/%Y"),
         DATE_CTMAX = as.Date(DATE_CTMAX, format = "%d/%m/%Y"),
         DEV_TEMP = factor(DEV_TEMP), 
         LEVEL = as.factor(case_when(TANK >= 1 & TANK <= 199 ~ 1,
                           TANK >= 200 & TANK <= 299 ~ 2,
                           TANK >= 300 & TANK <= 399 ~ 3,
                           TRUE ~ NA_real_)), 
          
         TANK = factor(TANK)) |> 
  left_join(distinct(select(clutch_data, c("CLUTCH_NUMBER", "FEMALE","FEMALE_LAT","CLUTCH_ORDER")), FEMALE, .keep_all = TRUE), by="FEMALE") |> 
  mutate(CLUTCH_ORDER = factor(CLUTCH_ORDER)) |>
  filter(LOE_MEAN_EAS >= 35) |> 
  drop_na(FEMALE) |> 
  drop_na(POPULATION) |> 
  drop_na(TANK) |> 
  drop_na(LEVEL) |> 
  drop_na(CLUTCH_ORDER) |> 
  drop_na(EXPERIMENT) |> 
  drop_na(TRAY_COL) |> 
  drop_na(TRAY_ORD)
```

# Exploratory data analysis 

```{r eda-1, fig.width=18, fig.height=8}
p1 <- ggplot(ctmax2, aes(x=REGION, y=LOE_MEAN_EAS, color=DEV_TEMP)) + 
  geom_boxplot() + 
  theme_classic()

p2 <- ggplot(ctmax2, aes(x=REGION, y=LOE_MEAN_EAS, color=DEV_TEMP)) + 
  geom_violin() + 
  theme_classic()

p3 <- ggplot(ctmax2, aes(x=DATE_CTMAX, y=LOE_MEAN_EAS, color = DATE_CTMAX)) + 
  geom_point() + 
  ggtitle("Batchs") +
  theme_classic()

ggarrange(p1,p2,p3, 
          nrow=1, 
          ncol=3)
```

# Fit model [random factors] 

First we will place random factors only within out model and see if they do a good job explaining the variance within our model. We will also be include piors which will be based off of out length data.

##  Prior investigation 
```{r }
ctmax2 |> 
  group_by(REGION,DEV_TEMP) |> 
  summarise(mean(na.omit(LOE_MEAN_EAS)), 
            sd(na.omit(LOE_MEAN_EAS))) 

```

## Priors 
```{r}
ctmax.priors.re <- prior(normal(37.0, 0.50), class="Intercept") +  
  prior(student_t(3, 0, 0.1975), class = "sigma")
```

## Models {.tabset}

### Null
```{r fit-model-null, cache=TRUE} 
f.model.null <- bf(LOE_MEAN_EAS ~ 1, 
                   family=gaussian())
model.null <- brm(f.model.null,
                   data = ctmax2, 
                   prior = ctmax.priors.re,
                   warmup = 500, 
                   iter = 5000,
                   seed=123, 
                   cores=2, 
                   save_pars = save_pars(all=TRUE),  
                   sample_prior = "yes",
                   chains = 2, 
                   thin = 5, 
                   control = list(adapt_delta=0.95)) 
saveRDS(model.null, file="./04.CTmax_data_analysis_files/model.null.RDS")
```

### Model1

```{r fit-model1, cache=TRUE} 
f.model1 <- bf(LOE_MEAN_EAS ~ 1 + (1| FEMALE) + (1| TANK), 
               family=gaussian())
model1 <- brm(f.model1,
                   data = ctmax2, 
                   prior = ctmax.priors.re,
                   warmup = 500, 
                   iter = 5000,
                   seed=123, 
                   cores=2, 
                   save_pars = save_pars(all=TRUE),  
                   sample_prior = "yes",
                   chains = 2, 
                   thin = 5, 
                   control = list(adapt_delta=0.95)) 
saveRDS(model1, file="./04.CTmax_data_analysis_files/model1.RDS")
```

### Model2
```{r fit-model2, cache=TRUE}
f.model2 <- bf(LOE_MEAN_EAS ~ 1 + (1| FEMALE) + (1| TANK) + (1| LEVEL), 
               family=gaussian())
model2 <- brm(f.model2,
                   data = ctmax2, 
                   prior = ctmax.priors.re,
                   warmup = 500, 
                   iter = 5000,
                   seed=123, 
                   cores=2, 
                   save_pars = save_pars(all=TRUE),  
                   sample_prior = "yes",
                   chains = 2, 
                   thin = 5, 
                   control = list(adapt_delta=0.95))  
saveRDS(model2, file="./04.CTmax_data_analysis_files/model2.RDS")
```

### Model3
```{r fit-model3-pop, cache=TRUE} 
f.model3 <- bf(LOE_MEAN_EAS ~ 1 + (1| FEMALE) + (1| EXP_TANK) + (1| TRAY_ORD), 
               family=gaussian())
model3 <- brm(f.model3,
                   data = ctmax2, 
                   prior = ctmax.priors.re,
                   warmup = 500, 
                   iter = 5000,
                   seed=123, 
                   cores=2, 
                   save_pars = save_pars(all=TRUE),  
                   sample_prior = "yes",
                   chains = 2, 
                   thin = 5, 
                   control = list(adapt_delta=0.95)) 
saveRDS(model3, file="./04.CTmax_data_analysis_files/model3.RDS")
```

### Model4 
```{r fit-model4-pop, cache=TRUE} 
f.model4 <- bf(LOE_MEAN_EAS ~ 1 + (1| FEMALE) + (1| EXP_TANK) + (1| TRAY_ORD) + (1| EXPERIMENT), 
               family=gaussian())
model4 <- brm(f.model4,
                   data = ctmax2, 
                   prior = ctmax.priors.re,
                   warmup = 500, 
                   iter = 5000,
                   seed=123, 
                   cores=2, 
                   save_pars = save_pars(all=TRUE),  
                   sample_prior = "yes",
                   chains = 2, 
                   thin = 5, 
                   control = list(adapt_delta=0.95)) 
saveRDS(model4, file="./04.CTmax_data_analysis_files/model4.RDS")
```


### Model5
```{r fit-model5, cache=TRUE} 
f.model5 <- bf(LOE_MEAN_EAS ~ 1 + (1| FEMALE) + (1| TANK) + (1| LEVEL) + (1| POPULATION), 
               family=gaussian())
model5 <- brm(f.model5,
                   data = ctmax2, 
                   prior = ctmax.priors.re,
                   warmup = 500, 
                   iter = 5000,
                   seed=123, 
                   cores=2, 
                   save_pars = save_pars(all=TRUE),  
                   sample_prior = "yes",
                   chains = 2, 
                   thin = 5, 
                   control = list(adapt_delta=0.95)) 
saveRDS(model5, file="./04.CTmax_data_analysis_files/model5.RDS")
```

### Model6 
```{r fit-model6, cache=TRUE} 
f.model6 <- bf(LOE_MEAN_EAS ~ 1 + (1| FEMALE) + (1| TANK) + (1| LEVEL) + (1| POPULATION) + (1| CLUTCH_ORDER), 
               family=gaussian())
model6 <- brm(f.model6,
                   data = ctmax2, 
                   prior = ctmax.priors.re,
                   warmup = 500, 
                   iter = 5000,
                   seed=123, 
                   cores=2, 
                   save_pars = save_pars(all=TRUE),  
                   sample_prior = "yes",
                   chains = 2, 
                   thin = 5, 
                   control = list(adapt_delta=0.95)) 
saveRDS(model6, file="./04.CTmax_data_analysis_files/model6.RDS")
```
### LOO
```{r model-comparisons-2, cache=TRUE}
LOO(model.null,model1,model2,model3,model4,model5,model6) 
```

### {-}

# Fit model [fixed factors] 

##  Prior investigation 
```{r }
ctmax2 |> 
  group_by(REGION,DEV_TEMP) |> 
  summarise(mean(na.omit(LOE_MEAN_EAS)), 
            sd(na.omit(LOE_MEAN_EAS))) 

```

## Priors 
```{r}
ctmax.priors <- prior(normal(37.0, 0.50), class="Intercept") +  
  prior(normal(0, 0.05), class ="b") +
  prior(student_t(3, 0, 0.1975), class = "sigma") 
```

## Models {.tabset}
### Model1.1 {.tabset}
```{r model1.1, cache=TRUE}
f.model1.1 <- bf(LOE_MEAN_EAS ~ 1 + DEV_TEMP*REGION + 
                       scale(MASS, center=TRUE, scale=TRUE) + 
                       (1| FEMALE) + (1| TANK) + (1| LEVEL) + (1| POPULATION) + (1| CLUTCH_ORDER), 
                     family=gaussian())

model1.1 <- brm(f.model1.1,
              data = ctmax2,
              prior =ctmax.priors,
              warmup = 500, 
              iter = 5000,
              seed=123, 
              cores=2, 
              save_pars = save_pars(all=TRUE),  
              sample_prior= "yes",
              chains = 2, 
              thin = 5, 
              control = list(adapt_delta=0.95))
saveRDS(model1.1, file="./04.CTmax_data_analysis_files/model1.1.RDS")
```

#### DHARMa 
```{r model1.1-dharma}
#--- distribution check ---#
pp_check(model1.1, type = 'dens_overlay_grouped', ndraws=150, group="REGION")

#--- DHARMa checks ---#
preds <- posterior_predict(model1.1, ndraws=250, summary=FALSE)
model1.1_resids <- createDHARMa(simulatedResponse = t(preds), 
                              observedResponse = na.omit(ctmax2$LOE_MEAN_EAS), 
                              fittedPredictedResponse = apply(preds, 2, mean), 
                              integerResponse = 'student')
plot(model1.1_resids) ; testDispersion(model1.1_resids)
```

#### MCMC diagnositics 
```{r mcmc-diag-model1.1, fig.height=9}
stan_trace(model1.1$fit, allpars=TRUE)
stan_ac(model1.1$fit) 
stan_rhat(model1.1$fit) 
stan_ess(model1.1$fit)
stan_dens(model1.1$fit, separate_chains = TRUE)
```
#### {-}

### Model1.2 {.tabset}
```{r Model1.2}
f.model1.2 <- bf(LOE_MEAN_EAS ~ 1 + DEV_TEMP*REGION + 
                   scale(FEMALE_LAT, center=TRUE, scale=TRUE) +
                   scale(MASS, center=TRUE, scale=TRUE) +
                   (1| FEMALE) + (1| TANK) + (1| LEVEL) + (1| POPULATION) + (1| CLUTCH_ORDER),
                 family=gaussian())

model1.2 <- brm(f.model1.2,
              data = ctmax2,
              prior =ctmax.priors,
              warmup = 500, 
              iter = 5000,
              seed=123, 
              cores=2, 
              save_pars = save_pars(all=TRUE),  
              sample_prior= "yes",
              chains = 2, 
              thin = 5, 
              control = list(adapt_delta=0.95))
saveRDS(model1.2, file="./04.CTmax_data_analysis_files/model1.2.RDS")
```

#### DHARMa 
```{r model1.2-dharma}
#--- distribution check ---#
pp_check(model1.2, type = 'dens_overlay_grouped', ndraws=150, group="REGION")

#--- DHARMa checks ---#
preds <- posterior_predict(model1.2, ndraws=250, summary=FALSE)
model1.2_resids <- createDHARMa(simulatedResponse = t(preds), 
                              observedResponse = na.omit(ctmax2$LOE_MEAN_EAS), 
                              fittedPredictedResponse = apply(preds, 2, mean), 
                              integerResponse = 'student')
plot(model1.2_resids) ; testDispersion(model1.2_resids)
```

#### MCMC diagnositics 
```{r mcmc-diag-model1.2, fig.height=9}
stan_trace(model1.2$fit, allpars=TRUE)
stan_ac(model1.2$fit) 
stan_rhat(model1.2$fit) 
stan_ess(model1.2$fit)
stan_dens(model1.2$fit, separate_chains = TRUE)
```
#### {-}

### Model1.3 {.tabset}

```{r}
ctmax.priors.gamma <- prior(normal(37.0, 0.50), class="Intercept") +  
  prior(normal(0, 0.05), class ="b")
```


```{r Model1.3}
f.model1.3 <- bf(LOE_MEAN_EAS ~ 1 + DEV_TEMP*REGION + 
                   scale(FEMALE_LAT, center=TRUE, scale=TRUE) +
                   scale(MASS, center=TRUE, scale=TRUE) +
                   (1| FEMALE) + (1| TANK) + (1| LEVEL) + (1| POPULATION) + (1| CLUTCH_ORDER),
                 family=Gamma(link="log"))

model1.3 <- brm(f.model1.3,
              data = ctmax2,
              prior =ctmax.priors.gamma,
              warmup = 500, 
              iter = 5000,
              seed=123, 
              cores=2, 
              save_pars = save_pars(all=TRUE),  
              sample_prior= "yes",
              chains = 2, 
              thin = 5, 
              control = list(adapt_delta=0.95))
saveRDS(model1.3, file="./04.CTmax_data_analysis_files/model1.3.RDS")
```

#### DHARMa 
```{r model1.3-dharma}
#--- distribution check ---#
pp_check(model1.3, type = 'dens_overlay_grouped', ndraws=150, group="REGION")

#--- DHARMa checks ---#
preds <- posterior_predict(model1.3, ndraws=250, summary=FALSE)
model1.3_resids <- createDHARMa(simulatedResponse = t(preds), 
                              observedResponse = na.omit(ctmax2$LOE_MEAN_EAS), 
                              fittedPredictedResponse = apply(preds, 2, mean), 
                              integerResponse = 'student')
plot(model1.3_resids) ; testDispersion(model1.3_resids)
```

#### MCMC diagnositics 
```{r mcmc-diag-model1.3, fig.height=9}
stan_trace(model1.3$fit, allpars=TRUE)
stan_ac(model1.3$fit) 
stan_rhat(model1.3$fit) 
stan_ess(model1.3$fit)
stan_dens(model1.3$fit, separate_chains = TRUE)
```
#### {-}

### LOO
```{r model-comparisons-3, cache=TRUE}
LOO(model1.1,model1.2, model1.3) 
```

### {- }

# partial plots 

```{r partial-plots-cond-eff-1}
model1.1 |> 
  conditional_effects(spaghetti = TRUE, ndraws=200) 
``` 

# Model investigation {.tabset .tabset-pills}

## summary 

```{r summary-100}
summary(model1.1)
```

## R2 

```{r r-squared}
model1.1 |> bayes_R2(summary = FALSE) |> median_hdci()
```

## tidyMCMC 

```{r tidy}
tidyMCMC(model1.1, estimate.method='median', conf.int=TRUE, conf.method='HPDinterval')
```

## gather draws 

```{r gather_draws}
#model1.1 |> get_variables()
model1.1 |> gather_draws(`b_.*|sigma`, regex =TRUE) |> 
  median_hdci()
``` 

## bayesplot 

```{r bayesplot-1}
model1.1 |> mcmc_plot(type='intervals')
```

## emmeans - pariwise 

```{r emmeans-pairwise}
model1.1 |> emmeans(pairwise ~ REGION*DEV_TEMP, type="response") |> pairs(by="DEV_TEMP") |> summary()
model1.1 |> emmeans(pairwise ~ REGION*DEV_TEMP, type="response") |> pairs(by="REGION") |> summary()
model1.1 |> emmeans(pairwise ~ REGION*DEV_TEMP, type="response") |> pairs(by="REGION") |> confint()
model1.1 |> emmeans(pairwise ~ REGION*DEV_TEMP, type="response")
model1.1 |> emmeans(pairwise ~ REGION*DEV_TEMP, type="response") |> regrid() 
```

## probabilities 
```{r probabilities}
mtsqst <- model1.1 |> emmeans(pairwise ~ REGION*DEV_TEMP)
mtsqrt1 <- mtsqst$contrasts |> gather_emmeans_draws()
mtsqrt1 %>% group_by(contrast) %>% dplyr::summarise(Prob = sum(.value>0)/n())
```
## {-}


# summary figure 

```{r summary-figure-1, warning=FALSE}
var <- get_variables(model1.1)
var1 <- get_variables(model1.1)[c(1:4,6,7)] 

int_draws_spread <- model1.1 |> spread_draws(!!!syms(var1)) 

int_draws_spread2 <- int_draws_spread |> 
  gather_draws(b_Intercept, b_REGIONleading) |> 
  left_join(int_draws_spread, by = c(".chain",".iteration",".draw"))
  
  
int_draws <- int_draws_spread2 |> 
  mutate(x28.5 = case_when(`.variable` == 'b_Intercept' ~ 
                                 `.value`, 
                               `.variable` != 'b_Intercept' ~ 
                                 `.value` + b_Intercept), 
         
         x30 = case_when(`.variable` == 'b_Intercept' ~ 
                                 `.value` + b_DEV_TEMP30, 
                             `.variable` == 'b_REGIONleading' ~ 
                                 `.value` + b_Intercept + b_DEV_TEMP30 + `b_DEV_TEMP30:REGIONleading`), 
         
         x31.5 = case_when(`.variable` == 'b_Intercept' ~ 
                                 `.value` + b_DEV_TEMP31.5, 
                             `.variable` == 'b_REGIONleading' ~ 
                                 `.value` + b_Intercept + b_DEV_TEMP31.5 + `b_DEV_TEMP31.5:REGIONleading`))
  
int_draws_plotting <- int_draws |> 
  pivot_longer(cols = starts_with("x"), 
               names_to = "DEV_TEMP", 
               values_to = "CTMAX") |> 
  transmute(LATITUDE = case_when(`.variable` == "b_Intercept" ~ "Low latitude", 
                                 `.variable` == "b_REGIONleading" ~ "High latitude"), 
            DEV_TEMP = case_when(DEV_TEMP == 'x28.5' ~ 'DEV_TEMP_28.5', 
                                 DEV_TEMP == 'x30' ~ 'DEV_TEMP_30', 
                                 DEV_TEMP == 'x31.5' ~ 'DEV_TEMP_31.5'),
            CTMAX = CTMAX, 
            LATITUDE_B = LATITUDE, 
            DEV_TEMP_B = DEV_TEMP,
            chain = `.chain`, 
            iteration = `.iteration`, 
            draw_n = `.draw`) |> 
  unite("EXP_GROUP",LATITUDE_B, DEV_TEMP_B,sep="_") |> 
  mutate(EXP_GROUP = as.factor(EXP_GROUP)) |> 
  mutate(EXP_GROUP = factor(EXP_GROUP, levels=c("High latitude_DEV_TEMP_28.5","High latitude_DEV_TEMP_30", "High latitude_DEV_TEMP_31.5",
                                                "Low latitude_DEV_TEMP_28.5","Low latitude_DEV_TEMP_30", "Low latitude_DEV_TEMP_31.5")))


ctmax.plot <- int_draws_plotting |> 
  ggplot(aes(x=EXP_GROUP, y=CTMAX)) + 
  #geom_hline(yintercept = 0, linetype="dashed", linewidth=1, color="grey58", alpha=0.8) + 
  stat_halfeye(aes(fill = EXP_GROUP, fill_ramp = after_stat(level)), 
               point_interval = median_hdci, 
               .width = c(.66, .90, .95)) + 
  scale_fill_ramp_discrete(na.translate=FALSE, 
                           labels =c("0.95","0.89","0.66"), 
                           name = "Credible interval") +
  scale_fill_manual(values = c("lightskyblue" ,"dodgerblue2", "dodgerblue4","coral", "red2","firebrick4"))+ 
  #scale_y_continuous(limits=c(-6,6), breaks = seq(-6,6, 1))+
  ylab("Temperature (\u00B0C)") + xlab("EXPERIMENTAL GROUP") +
  scale_x_discrete(labels = c("Low latitude_DEV_TEMP_28.5" = paste0("Low latitude 28.5","\u00B0","C"), 
                              "Low latitude_DEV_TEMP_30" = paste0("Low latitude 30","\u00B0","C"),
                              "Low latitude_DEV_TEMP_31.5" = paste0("Low latitude 31.5","\u00B0","C"), 
                              "High latitude_DEV_TEMP_28.5" = paste0("High latitude 28.5","\u00B0","C"),
                              "High latitude_DEV_TEMP_30" = paste0("High latitude 30","\u00B0","C"),
                              "High latitude_DEV_TEMP_31.5" = paste0("High latitude 31.5","\u00B0","C"))) +
  #annotate("text", x=6.8,y=1.4, label = paste0(round(mean(ctmax2$ctmax), 2)," (mm)"), color="grey58") +
  coord_flip() + 
  theme_classic() + 
  guides(fill = "none") + 
  theme(legend.position = c(.18,.86), 
        axis.title.y = element_text(margin = margin(r =0.3, unit = "in"), size = 12), 
        axis.title.x = element_text(margin = margin(t = 0.3, unit="in"), size =12), 
        legend.key = element_rect(color="black", size=1.25)); ctmax.plot
```


```{r eval=FALSE, echo=TRUE}
ggsave(file="./figures/ctmax.plot.svg",  plot=ctmax.plot, width=8, height=5, units = "in", dpi=300) 
ggsave(file="./figures/ctmax.plot.pdf",  plot=ctmax.plot, width=8, height=5, units = "in", dpi=300)
```